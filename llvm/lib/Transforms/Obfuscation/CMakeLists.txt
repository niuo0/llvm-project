add_llvm_library(LLVMObfuscation
  CryptoUtils.cpp
  BogusControlFlow.cpp
  Substitution.cpp
  Flattening.cpp
  Utils.cpp
  SplitBasicBlocks.cpp
  StringEncryption.cpp
  Obfuscation.cpp
  MBAUtils.cpp
  MBAObfuscation.cpp
  SymbolObfuscation.cpp
  
  DEPENDS
  intrinsics_gen
  )
execute_process(
  COMMAND git log -1 --format=%H
  WORKING_DIRECTORY ${CMAKE_CURRENT_LIST_DIR}
  OUTPUT_VARIABLE HIKARI_GIT_COMMIT_HASH
  OUTPUT_STRIP_TRAILING_WHITESPACE
)
target_compile_definitions(LLVMObfuscation PRIVATE "-DGIT_COMMIT_HASH=\"${HIKARI_GIT_COMMIT_HASH}\"")
